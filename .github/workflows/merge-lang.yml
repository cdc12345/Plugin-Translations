name: Merge and Package Lang Files

on:
  push:
    branches: [ main ]
  workflow_dispatch:  # æ”¯æŒæ‰‹åŠ¨è§¦å‘

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1ï¸âƒ£ æ‹‰å–ä»“åº“ä»£ç 
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2ï¸âƒ£ è¯»å–ç‰ˆæœ¬å·
      - name: Read version
        id: version
        run: |
          if [ ! -f .version ]; then
            echo "âŒ æœªæ‰¾åˆ° .version æ–‡ä»¶"
            exit 1
          fi
          VERSION=$(tr -d ' \n\r' < .version)
          echo "version=$VERSION" >> $GITHUB_OUTPUT
          echo "ğŸ“¦ æ£€æµ‹åˆ°ç‰ˆæœ¬å·: $VERSION"

      # 3ï¸âƒ£ è¿è¡Œ Bash è„šæœ¬
      - name: Merge and package .properties files
        run: |
          chmod +x ./merge_properties.sh
          ./merge_properties.sh

      # 4ï¸âƒ£ ä¸Šä¼ æ„å»ºäº§ç‰©ï¼ˆZIP æ–‡ä»¶ï¼‰
      - name: Upload lang zip artifact
        uses: actions/upload-artifact@v4
        with:
          name: TranslationPatch-${{ steps.version.outputs.version }}
          path: TranslationPatch${{ steps.version.outputs.version }}.zip
